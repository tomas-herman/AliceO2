<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project: Workflows</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../o2_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('da/ddf/refDetectorsMUONMCHWorkflow.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Workflows </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>MCH Workflows</h1>
<ul>
<li><a href="../../#raw-to-digits">Raw to digits</a></li>
<li><a href="../../#digits-to-preclusters">Digits to preclusters</a></li>
<li><a href="../../#tracking">Tracking</a><ul>
<li><a href="../../#original-track-finder">Original track finder</a></li>
<li><a href="../../#new-track-finder">New track finder</a></li>
</ul>
</li>
<li><a href="../../#track-extrapolation-to-vertex">Track extrapolation to vertex</a></li>
<li><a href="../../#track-fitter">Track fitter</a></li>
<li><a href="../../#samplers">Samplers</a><ul>
<li><a href="../../#cluster-sampler">Cluster sampler</a></li>
<li><a href="../../#track-sampler">Track sampler</a></li>
<li><a href="../../#vertex-sampler">Vertex sampler</a></li>
</ul>
</li>
<li><a href="../../#sinks">Sinks</a><ul>
<li><a href="../../#preclusters-sink">Preclusters sink</a></li>
<li><a href="../../#track-sink">Track sink</a></li>
</ul>
</li>
</ul>
<h2>Raw to digits</h2>
<p><code>o2-mch-raw-to-digits-workflow</code></p>
<h2>Digits to preclusters</h2>
<p><code>o2-mch-digits-to-preclusters-workflow</code></p>
<p>Example of a DPL chain to go from a raw data file to a file of preclusters :</p>
<div class="fragment"><div class="line">o2-raw-file-reader-workflow --conf file-reader.cfg --loop 0  -b |</div><div class="line">o2-mch-raw-to-digits-workflow -b |</div><div class="line">o2-mch-digits-to-preclusters-workflow -b |</div><div class="line">o2-mch-preclusters-sink-workflow -b</div></div><!-- fragment --><p>where the <code>file-reader.cfg</code> looks like this:</p>
<div class="fragment"><div class="line">[input-0]</div><div class="line">dataOrigin = MCH</div><div class="line">dataDescription = RAWDATA</div><div class="line">filePath = /home/data/data-de819-ped-raw.raw</div></div><!-- fragment --><h2>Tracking</h2>
<h3>Original track finder</h3>
<p><code>o2-mch-clusters-to-tracks-original-workflow</code></p>
<p>Take as input the list of all clusters (<a href="../../../Base/include/MCHBase/ClusterBlock.h">ClusterStruct</a>) in the current time frame, with the data description "CLUSTERS", and the list of ROF records pointing to the clusters associated to each interaction, with the data description "CLUSTERROFS". Send the list of all MCH tracks (<a href="../../../../../../DataFormats/Detectors/MUON/MCH/include/DataFormatsMCH/TrackMCH.h">TrackMCH</a>) in the time frame, the list of all associated clusters (<a href="../../../Base/include/MCHBase/ClusterBlock.h">ClusterStruct</a>) and the list of ROF records pointing to the tracks associated to each interaction in three separate messages with the data description "TRACKS", "TRACKCLUSTERS" and "TRACKROFS", respectively.</p>
<p>Options <code>--l3Current xxx</code> and <code>--dipoleCurrent yyy</code> allow to specify the current in L3 and in the dipole to be used to set the magnetic field.</p>
<p>Option <code>--moreCandidates</code> allows to enable the search for more track candidates in stations 4 &amp; 5.</p>
<p>Option <code>--debug x</code> allows to enable the debug level x (0 = no debug, 1 or 2).</p>
<h3>New track finder</h3>
<p><code>o2-mch-clusters-to-tracks-workflow</code></p>
<p>Same behavior and options as <a href="../../#original-track-finder">Original track finder</a></p>
<h2>Track extrapolation to vertex</h2>
<p><code>o2-mch-tracks-to-tracks-at-vertex-workflow</code></p>
<p>Take as input the list of all MCH tracks (<a href="../../../../../../DataFormats/Detectors/MUON/MCH/include/DataFormatsMCH/TrackMCH.h">TrackMCH</a>) in the current time frame, the list of ROF records pointing to the tracks associated to each interaction and their vertex position (<code>Point3D&lt;double&gt;</code>), with the data description "TRACKS", "TRACKROFS" and "VERTICES", respectively. Send the list of all tracks at vertex (<code>TrackAtVtxStruct</code> as described below) in the time frame with the data description "TRACKSATVERTEX".</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>TrackAtVtxStruct {</div><div class="line">  TrackParamStruct paramAtVertex{};</div><div class="line">  <span class="keywordtype">double</span> dca = 0.;</div><div class="line">  <span class="keywordtype">double</span> rAbs = 0.;</div><div class="line">  <span class="keywordtype">int</span> mchTrackIdx = 0;</div><div class="line">};</div></div><!-- fragment --><p>Options <code>--l3Current xxx</code> and <code>--dipoleCurrent yyy</code> allow to specify the current in L3 and in the dipole to be used to set the magnetic field.</p>
<h2>Track fitter</h2>
<p><code>o2-mch-tracks-to-tracks-workflow</code></p>
<p>Take as input the list of all MCH tracks (<a href="../../../../../../DataFormats/Detectors/MUON/MCH/include/DataFormatsMCH/TrackMCH.h">TrackMCH</a>) in the current time frame, the list of all associated clusters (<a href="../../../Base/include/MCHBase/ClusterBlock.h">ClusterStruct</a>) and the list of ROF records pointing to the tracks associated to each interaction, with the data description "TRACKSIN", "TRACKCLUSTERSIN" and "TRACKROFSIN", respectively. Send the list of all refitted MCH tracks (<a href="../../../../../../DataFormats/Detectors/MUON/MCH/include/DataFormatsMCH/TrackMCH.h">TrackMCH</a>) in the time frame, the list of all associated clusters (<a href="../../../Base/include/MCHBase/ClusterBlock.h">ClusterStruct</a>) and the list of ROF records pointing to the tracks associated to each interaction in three separate messages with the data description "TRACKS", "TRACKCLUSTERS" and "TRACKROFS", respectively.</p>
<p>Options <code>--l3Current xxx</code> and <code>--dipoleCurrent yyy</code> allow to specify the current in L3 and in the dipole to be used to set the magnetic field.</p>
<h2>Samplers</h2>
<h3>Cluster sampler</h3>
<div class="fragment"><div class="line">o2-mch-clusters-sampler-workflow --infile &quot;clusters.in&quot;</div></div><!-- fragment --><p>where <code>clusters.in</code> is a binary file containing for each event:</p>
<ul>
<li>number of clusters (int)</li>
<li>number of associated digits (int)</li>
<li>list of clusters (<a href="../../../Base/include/MCHBase/ClusterBlock.h">ClusterStruct</a>)</li>
<li>list of associated digits (<a href="../../../Base/include/MCHBase/Digit.h">Digit</a>)</li>
</ul>
<p>Send the list of all clusters (<a href="../../../Base/include/MCHBase/ClusterBlock.h">ClusterStruct</a>) in the current time frame, with the data description "CLUSTERS", and the list of ROF records pointing to the clusters associated to each interaction, with the data description "CLUSTERROFS".</p>
<p>Option <code>--nEventsPerTF xxx</code> allows to set the number of events (i.e. ROF records) to send per time frame (default = 1)</p>
<h3>Track sampler</h3>
<p><code>o2-mch-tracks-sampler-workflow --infile "tracks.in"</code></p>
<p>where <code>tracks.in</code> is a binary file with the same format as the one written by the workflow <a href="../../#track-sink">o2-mch-tracks-sink-workflow</a></p>
<p>Send the list of all MCH tracks (<a href="../../../../../../DataFormats/Detectors/MUON/MCH/include/DataFormatsMCH/TrackMCH.h">TrackMCH</a>) in the current time frame, the list of all associated clusters (<a href="../../../Base/include/MCHBase/ClusterBlock.h">ClusterStruct</a>) and the list of ROF records pointing to the tracks associated to each interaction in three separate messages with the data description "TRACKS", "TRACKCLUSTERS" and "TRACKROFS", respectively.</p>
<p>Option <code>--forTrackFitter</code> allows to send the messages with the data description "TRACKSIN", "TRACKCLUSTERSIN" and TRACKROFSIN, respectively, as expected by the workflow <a href="../../#track-fitter">o2-mch-tracks-to-tracks-workflow</a>.</p>
<p>Option <code>--nEventsPerTF xxx</code> allows to set the number of events (i.e. ROF records) to send per time frame (default = 1)</p>
<h3>Vertex sampler</h3>
<p><code>o2-mch-vertex-sampler-workflow</code></p>
<p>Take as input the list of ROF records in the current time frame, with the data description "TRACKROFS". Send the list of all vertex positions (<code>Point3D&lt;double&gt;</code>) in the time frame, one per interaction, with the data description "VERTICES".</p>
<p>Option <code>--infile "vertices.in"</code> allows to read the position of the vertex from the binary file <code>vertices.in</code> containing for each event:</p>
<ul>
<li>event number (int)</li>
<li>x (double)</li>
<li>y (double)</li>
<li>z (double)</li>
</ul>
<p>If no binary file is provided, the vertex is always set to (0,0,0).</p>
<h2>Sinks</h2>
<h3>Preclusters sink</h3>
<p><code>o2-mch-preclusters-sink-workflow</code></p>
<h3>Track sink</h3>
<p><code>o2-mch-tracks-sink-workflow --outfile "tracks.out"</code></p>
<p>Take as input the list of all tracks at vertex (<a href="../../#track-extrapolation-to-vertex">TrackAtVtxStruct</a>) in the current time frame, the list of all MCH tracks (<a href="../../../../../../DataFormats/Detectors/MUON/MCH/include/DataFormatsMCH/TrackMCH.h">TrackMCH</a>), the list of all associated clusters (<a href="../../../Base/include/MCHBase/ClusterBlock.h">ClusterStruct</a>) and the list of ROF records pointing to the MCH tracks associated to each interaction, with the data description "TRACKSATVERTEX", "TRACKS", "TRACKCLUSTERS" and "TRACKROFS", respectively, and write them event-by-event in the binary file <code>tracks.out</code> with the following format for each event:</p>
<ul>
<li>number of tracks at vertex (int)</li>
<li>number of MCH tracks (int)</li>
<li>number of associated clusters (int)</li>
<li>list of tracks at vertex (<a href="../../#track-extrapolation-to-vertex">TrackAtVtxStruct</a>)</li>
<li>list of MCH tracks (<a href="../../../../../../DataFormats/Detectors/MUON/MCH/include/DataFormatsMCH/TrackMCH.h">TrackMCH</a>)</li>
<li>list of associated clusters (<a href="../../../Base/include/MCHBase/ClusterBlock.h">ClusterStruct</a>)</li>
</ul>
<p>Option <code>--tracksAtVertexOnly</code> allows to take as input and write only the tracks at vertex (number of MCH tracks and number of associated clusters = 0).</p>
<p>Option <code>--mchTracksOnly</code> allows to take as input and write only the MCH tracks and associated clusters (number of tracks at vertex = 0). </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d0/d2f/refDetectors.html">Module &#39;Detectors&#39;</a></li><li class="navelem"><a class="el" href="../../d4/dff/refDetectorsMUON.html">MUON</a></li><li class="navelem"><a class="el" href="../../d0/daf/refDetectorsMUONMCH.html">MCH</a></li>
    <li class="footer">Generated on Sat Jan 23 2021 12:44:30 for Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
